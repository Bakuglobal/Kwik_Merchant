<ion-content color="primary">
  <ion-toolbar color="primary">
    <ion-buttons slot="start" padding>
      <ion-icon name="arrow-back" (click)="back()"></ion-icon>
    </ion-buttons>
    <ion-title>Add to stock</ion-title>
  </ion-toolbar>
  <div class="body" *ngIf="type">

    <div class="buttons">
      <ion-button expand="block" shape="round" (click)="addNewProduct()">New Product</ion-button><br><br><br>
      <ion-button expand="block" shape="round" (click)="existingProduct()">Existing Product</ion-button><br><br><br>
      <ion-button expand="block" shape="round" (click)="categoryModal()">New Category</ion-button>
    </div>
  </div>
  <div class="body" *ngIf="existing">
    <ion-buttons slot="start" style="padding-top: 10px;">
      <ion-button (click)="close()">
        <ion-icon size="large" color="primary" name="close"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-row padding text-center>
      <ion-col>
        <ion-label class="title">Choose category to filter</ion-label>
        <ion-select placeholder="category" [(ngModel)]="category" (ionChange)="setFilteredItems()">
          <ion-select-option *ngFor="let item of categories.categories">{{item.name}}</ion-select-option>
        </ion-select>
      </ion-col>
      <ion-col size="4">
        <ion-icon name="pricetags" class="image" color="primary"></ion-icon>
      </ion-col>
    </ion-row>
    <ion-item text-center *ngIf="category != null">
      <ion-input type="text" clearInput placeholder="Enter product name"></ion-input>
      <ion-icon name="search" slot="end"></ion-icon>
    </ion-item>
    <ion-item text-center color="medium">
      <ion-col size="2">
        Icon
      </ion-col>
      <ion-col size="4">
        Product
      </ion-col>
      <ion-col size="2">
        Stock
      </ion-col>
      <ion-col size="2">
        Units
      </ion-col>
      <ion-col size="2">
        Price
      </ion-col>
    </ion-item>
    <ion-item text-center (click)="viewProduct(item)" *ngFor="let item of products">
      <ion-col text-center size="2">
        <ion-thumbnail>
          <img [src]="item.image">
        </ion-thumbnail>
      </ion-col>
      <ion-col size="4">
        {{item.product}}
      </ion-col>
      <ion-col size="2">
        {{item.stock}}
      </ion-col>
      <ion-col size="2">
        {{item.quantity}}
      </ion-col>
      <ion-col size="2">
        {{item.currentprice}}
      </ion-col>
    </ion-item>

  </div>

  <div *ngIf="newProduct" class="body">
    <ion-buttons slot="start" style="padding-top: 10px;">
      <ion-button (click)="close()">
        <ion-icon size="large" color="primary" name="close"></ion-icon>
      </ion-button>
    </ion-buttons>
    <form (ngSubmit)="addProduct()" [formGroup]="productForm">
      <ion-list>
        <ion-item>
          <ion-input type="text" formControlName="product" placeholder="Enter Product name" required></ion-input>
        </ion-item>
        <ion-item>
          <ion-input max="25" min="12" type="number" formControlName="barcode" placeholder="Scan or Enter barcode" ></ion-input>
          <ion-icon slot="end" name="qr-scanner" (click)="scan()"></ion-icon>
        </ion-item>
        <ion-item (click)="selectCategory()">
          <ion-label>Select Category </ion-label>
          <ion-input placeholder="Select Category" required slot="end" formControlName="category" value="{{value}}">
            <ion-icon name="arrow-dropdown" color="medium"></ion-icon>
          </ion-input>
        </ion-item>
        <ion-item>
          <ion-input type="number" formControlName="stock" placeholder="Enter Quantity available" required>
          </ion-input>
        </ion-item>
        <ion-item>
          <ion-input type="text" formControlName="quantity" placeholder="Enter Product Unit" required></ion-input>
        </ion-item>
        <ion-item>
          <ion-input type="text" formControlName="currentprice" placeholder="Enter Product Price" required></ion-input>
        </ion-item>
        <ion-item>
          <ion-input type="text" formControlName="description" placeholder="Enter Description"></ion-input>
        </ion-item>
        <ion-item>
          <ion-label>Set product status </ion-label>
          <ion-select formControlName="status" slot="end" placeholder="Select">
            <ion-select-option selected>Available</ion-select-option>
            <ion-select-option>Unavailable</ion-select-option>
          </ion-select>
          <!-- <ion-toggle checked slot="end" formControlName="status"></ion-toggle> -->
        </ion-item>
        <ion-item (click)="selectImage()">
          <ion-label>Image:</ion-label>
          <ion-input formControlName="image" value="{{image}}" ></ion-input>
          <ion-icon slot="end" name="camera"></ion-icon>
        </ion-item>
        <ion-button expand="full " type="submit" shape="round" [disabled]="!productForm.valid"
          style="margin-top: 50px;">Save</ion-button>
      </ion-list>
    </form>
  </div>
</ion-content>